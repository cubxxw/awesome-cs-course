+ [author](https://github.com/3293172751)
+ <a href="https://github.com/3293172751" target="_blank"><img src="https://img.shields.io/badge/Github-xiongxinwei-inactive?style=social&logo=github"></a></p>

# ç¬¬27èŠ‚ Druidè¿æ¥æ± å’Œæ¡ˆä¾‹

+ [å›åˆ°ç›®å½•](../README.md)
+ [å›åˆ°é¡¹ç›®é¦–é¡µ](../../README.md)
+ [ä¸Šä¸€èŠ‚](26.md)
> â¤ï¸ğŸ’•ğŸ’•javaçš„å­¦ä¹ æŒ‡å—,ä»å…¥é—¨åˆ°å¤§å¸ˆç¯‡ç« ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)
---
[TOC]

## æ•°æ®åº“è¿æ¥æ± 

æˆ‘ä»¬åœ¨è®²å¤šçº¿ç¨‹çš„æ—¶å€™è¯´è¿‡ï¼Œåˆ›å»ºçº¿ç¨‹æ˜¯ä¸€ä¸ªæ˜‚è´µçš„æ“ä½œï¼Œå¦‚æœæœ‰å¤§é‡çš„å°ä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œå¹¶ä¸”é¢‘ç¹åœ°åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ï¼Œå®é™…ä¸Šä¼šæ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºï¼Œå¾€å¾€åˆ›å»ºå’Œæ¶ˆè€—çº¿ç¨‹æ‰€è€—è´¹çš„æ—¶é—´æ¯”æ‰§è¡Œä»»åŠ¡çš„æ—¶é—´è¿˜é•¿ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œå¯ä»¥ç”¨çº¿ç¨‹æ± ã€‚

ç±»ä¼¼çš„ï¼Œåœ¨æ‰§è¡ŒJDBCçš„å¢åˆ æ”¹æŸ¥çš„æ“ä½œæ—¶ï¼Œå¦‚æœæ¯ä¸€æ¬¡æ“ä½œéƒ½æ¥ä¸€æ¬¡æ‰“å¼€è¿æ¥ï¼Œæ“ä½œï¼Œå…³é—­è¿æ¥ï¼Œé‚£ä¹ˆåˆ›å»ºå’Œé”€æ¯JDBCè¿æ¥çš„å¼€é”€å°±å¤ªå¤§äº†ã€‚ä¸ºäº†é¿å…é¢‘ç¹åœ°åˆ›å»ºå’Œé”€æ¯JDBCè¿æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿æ¥æ± ï¼ˆConnection Poolï¼‰å¤ç”¨å·²ç»åˆ›å»ºå¥½çš„è¿æ¥ã€‚

JDBCè¿æ¥æ± æœ‰ä¸€ä¸ªæ ‡å‡†çš„æ¥å£`javax.sql.DataSource`ï¼Œæ³¨æ„è¿™ä¸ªç±»ä½äºJavaæ ‡å‡†åº“ä¸­ï¼Œä½†ä»…ä»…æ˜¯æ¥å£ã€‚è¦ä½¿ç”¨JDBCè¿æ¥æ± ï¼Œæˆ‘ä»¬å¿…é¡»é€‰æ‹©ä¸€ä¸ªJDBCè¿æ¥æ± çš„å®ç°ã€‚å¸¸ç”¨çš„JDBCè¿æ¥æ± æœ‰ï¼š

- HikariCP
- C3P0
- BoneCP
- Druid



## Druid

+ druidè¿æ¥æ± æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„æ•°æ®åº“è¿æ¥æ± é¡¹ç›®
+ åŠŸèƒ½å¼ºå¤§ï¼Œæ€§èƒ½ä¼˜ç§€ï¼Œæ˜¯Javaè¯­è¨€æœ€å¥½çš„æ•°æ®åº“è¿æ¥æ± ä¹‹ä¸€

ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯Druidã€‚æˆ‘ä»¬ä»¥Druidä¸ºä¾‹ï¼Œè¦ä½¿ç”¨JDBCè¿æ¥æ± ï¼Œå…ˆæ·»åŠ Druidçš„ä¾èµ–å¦‚ä¸‹ï¼š

```xml
<dependency>
    <groupId>com.zaxxer</groupId>
    <artifactId>HikariCP</artifactId>
    <version>2.7.1</version>
</dependency>
```



## mavenä½¿ç”¨druid

**é…ç½®ï¼š**

```bash
driverClassName=com.mysql.cj.jdbc.Driver
url=jdbc:mysql://127.0.0.1:3306/byshop?serverTimezone=PRC
username=byshop 
password=Bs1357.
initialSize=10
minIdle=1
maxActive=10
maxWait=10000
timeBetweenEvictionRunsMillis=6000
minEvictableIdleTimeMillis=300000
testWhileIdle=true
testOnBorrow=true
testOnReturn=true
poolPreparedStatements=true
maxPoolPreparedStatementPerConnectionSize=20
validationQuery=select 1
filters=stat
```



1. åˆ›å»ºresourcesæ–‡ä»¶å¤¹å’Œdruid.propertiesæ–‡ä»¶

2. DruidDataSourceé…ç½®å±æ€§åˆ—è¡¨åŠæ–‡ä»¶æ­£å¸¸é…ç½®

![image-20220922192604694](https://sm.nsddd.top//typora/image-20220922192604694.png?mail:3293172751@qq.com)



### ä½¿ç”¨

> æ³¨æ„é…ç½®æ–‡ä»¶çš„è·¯å¾„

```java
public class JdbcUtils {

    private static JdbcUtils instance;

    DataSource dataSource;


    /**
     * è·å–å½“å‰ç±»çš„å®ä¾‹å¯¹è±¡
     *
     * @return
     */
    public static JdbcUtils getInstance() {
        if (null == instance) {
            instance = new JdbcUtils();
        }
        return instance;
    }

    /*
     * è¯»å–é…ç½®æ–‡ä»¶
     * */
    private JdbcUtils() {
    	//æ•°æ®æºé…ç½®
        Properties prop = new Properties();
        //è¯»å–é…ç½®æ–‡ä»¶
        InputStream is = JdbcUtils.class.getResourceAsStream("/druid.properties");
        try {
            prop.load(is);
        } catch (IOException e) {
            e.printStackTrace();
        }
        try {
        	//è¿”å›çš„æ˜¯DataSource
            dataSource = DruidDataSourceFactory.createDataSource(prop);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

	/**å…³é—­é“¾æ¥
     * @return
     */
    public Connection getConnection() {
        Connection conn = null;
        try {
            conn = dataSource.getConnection();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return conn;
    }
}
```







## æ¡ˆä¾‹

> **å®Œæˆå•†å“å“ç‰Œæ•°æ®çš„å¢åˆ æ”¹æŸ¥æ“ä½œ**

### åˆ›å»ºæ•°æ®è¡¨ tb_brand

+ å½“å‰çš„æ•°æ®åº“ï¼š`db3`

```sql
-- åˆ é™¤tb_brandè¡¨
drop table if exists tb_brand;
 
-- åˆ›å»ºtb_brandè¡¨
create table tb_brand (
    -- id ä¸»é”®
    id int primary key auto_increment,
    -- å“ç‰Œåç§°
    brand_name varchar(20),
    -- ä¼ä¸šåç§°
    company_name varchar(20),
    -- æ’åºå­—æ®µ
    ordered int,
    -- æè¿°ä¿¡æ¯
    description varchar(100),
    -- çŠ¶æ€ï¼š0ï¼šç¦ç”¨  1ï¼šå¯ç”¨
    status int
);
-- æ·»åŠ æ•°æ®
insert into tb_brand (brand_name, company_name, ordered, description, status) values ('ä¸‰åªæ¾é¼ ', 'ä¸‰åªæ¾é¼ è‚¡ä»½æœ‰é™å…¬å¸', 5, 'å¥½åƒä¸ä¸Šç«', 0), ('åä¸º', 'åä¸ºæŠ€æœ¯æœ‰é™å…¬å¸', 100, 'åä¸ºè‡´åŠ›äºæŠŠæ•°å­—ä¸–ç•Œå¸¦å…¥æ¯ä¸ªäººã€æ¯ä¸ªå®¶åº­ã€æ¯ä¸ªç»„ç»‡ï¼Œæ„å»ºä¸‡ç‰©äº’è”çš„æ™ºèƒ½ä¸–ç•Œ', 1),('å°ç±³', 'å°ç±³ç§‘æŠ€æœ‰é™å…¬å¸', 50, 'are you ok', 1);
 
SELECT * FROM tb_brand;
 
```

1	xiaomi	xiaomigongsi	50	are you ok	1
2	huawei	xiaomigongsi	50	are you ok	1
3	huawei	xiaomigongsi	50	are you ok	1
4	huawei	huawei yyds	50	are you ok	1
5	rongyao	huawei yyds	50	are you ok	1
6	yamaxun	huawei yyds	50	are you ok	1
7	google	huawei yyds	50	are you ok	1



### å®ä½“ç±» Brand

**å› ä¸ºåŸºæœ¬æ•°æ®ç±»å‹éƒ½æ˜¯æœ‰é»˜è®¤å€¼ï¼Œå¯èƒ½ä¼šç»™æˆ‘ä»¬å¸¦æ¥å¹²æ‰°ï¼Œæ‰€ä»¥å»ºè®®åœ¨å®ä½“ç±»ä¸­éƒ½å»ºè®®ä½¿ç”¨åŒ…è£…ç±»å‹**

```java
package top.nsddd.top;
/*
å“ç‰Œ
* */
public class Brand {
    //å»ºè®®Integerï¼Œå› ä¸ºintåŸºæœ¬æ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¸º0
//    æ‰¹é‡ç”Ÿæˆæ‰€æœ‰çš„æ•°æ®
    // id ä¸»é”®
   private Integer id;
    // å“ç‰Œåç§°
   private String brand_name;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getBrand_name() {
        return brand_name;
    }

    public void setBrand_name(String brand_name) {
        this.brand_name = brand_name;
    }

    public String getCompany_name() {
        return company_name;
    }

    public void setCompany_name(String company_name) {
        this.company_name = company_name;
    }

    public Integer getOrdered() {
        return ordered;
    }

    public void setOrdered(Integer ordered) {
        this.ordered = ordered;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public Integer getStatus() {
        return status;
    }

    public void setStatus(Integer status) {
        this.status = status;
    }

    // ä¼ä¸šåç§°
   private String company_name;
    // æ’åºå­—æ®µ
   private Integer ordered ;
    // æè¿°ä¿¡æ¯
   private String description;
    // çŠ¶æ€ï¼š0ï¼šç¦ç”¨  1ï¼šå¯ç”¨
   private Integer status;


    @Override
    public String toString() {
        return "Brand{" +
                "id=" + id +
                ", brand_name='" + brand_name + '\'' +
                ", company_name='" + company_name + '\'' +
                ", ordered=" + ordered +
                ", description='" + description + '\'' +
                ", status=" + status +
                '}';
    }

}
```

`test`

```java
package top.nsddd.top;

import com.alibaba.druid.pool.DruidDataSourceFactory;
import org.junit.Test;
import javax.sql.DataSource;
import java.io.FileInputStream;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.*;

public class BrandTest {

    @Test
    public void testSelectAll() throws Exception {
        //1\. è·å–Connection
        //åŠ è½½é…ç½®æ–‡ä»¶
        Properties prop = new Properties();
        prop.load(new FileInputStream("/druid.properties"));

        //è·å–è¿æ¥æ± å¯¹è±¡
        DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);

        //è·å–æ•°æ®åº“è¿æ¥ Connection
        Connection conn = dataSource.getConnection();

        //2\. å®šä¹‰SQL
        String sql = "select * from tb_brand";

        //3\. è·å–pstmtå¯¹è±¡
        PreparedStatement pstmt = conn.prepareStatement(sql);

        //4\. è®¾ç½®å‚æ•°

        //5\. æ‰§è¡ŒSQL
        ResultSet rs = pstmt.executeQuery();

        //6\. å¤„ç†ç»“æœ
        Brand brand = null;
        List<Brand> brands = new ArrayList<>();

        while(rs.next()){
            //è·å–æ•°æ®
            int id = rs.getInt("id");
            String brandName = rs.getString("brand_name");
            String companyName = rs.getString("company_name");
            int ordered = rs.getInt("ordered");
            String description = rs.getString("description");
            int status = rs.getInt("status");
            //å°è£…Brandå¯¹è±¡
            brand = new Brand();
            brand.setId(id);
            brand.setBrand_name(brandName);
            brand.setCompany_name(companyName);
            brand.setOrdered(ordered);
            brand.setDescription(description);
            brand.setStatus(status);
            //è£…è½½é›†åˆ
            brands.add(brand);
        }
        //æ‰“å°ä¸€ä¸‹
        for(Brand b:brands){
            System.out.println(b);
        }

        //7\. é‡Šæ”¾èµ„æº
        rs.close();
        pstmt.close();
        conn.close();
    }
}
 
```





## END é“¾æ¥
+ [å›åˆ°ç›®å½•](../README.md)
+ [ä¸Šä¸€èŠ‚](26.md)
+ [ä¸‹ä¸€èŠ‚](28.md)
---
+ [å‚ä¸è´¡çŒ®â¤ï¸ğŸ’•ğŸ’•](https://github.com/3293172751/Block_Chain/blob/master/Git/git-contributor.md)