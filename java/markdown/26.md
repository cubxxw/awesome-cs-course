+ [author](https://github.com/3293172751)
+ <a href="https://github.com/3293172751" target="_blank"><img src="https://img.shields.io/badge/Github-xiongxinwei-inactive?style=social&logo=github"></a></p>
# ç¬¬26èŠ‚ mavenåˆ›å»ºjdbcè¿æ¥MySQL
+ [å›åˆ°ç›®å½•](../README.md)
+ [å›åˆ°é¡¹ç›®é¦–é¡µ](../../README.md)
+ [ä¸Šä¸€èŠ‚](25.md)
> â¤ï¸ğŸ’•ğŸ’•javaçš„å­¦ä¹ æŒ‡å—,ä»å…¥é—¨åˆ°å¤§å¸ˆç¯‡ç« ã€‚Myblog:[http://nsddd.top](http://nsddd.top/)
---
[TOC]

## å¯¼å…¥æ¨¡å—

```xml
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>8.0.30</version>
        </dependency>
```

**è¿™ä¸ªæ—¶å€™å°±å¯ä»¥å¯¼å…¥ï¼š**

```java
Class.forName("com.mysql.jdbc.Driver");
```

**æ­¤æ—¶ä¼šæœ‰å¼‚å¸¸ï¼ŒIDEAè´´å¿ƒæé†’ï¼Œæ‹…å¿ƒä½ åé¢å†™çš„ä¸œè¥¿é”™äº†ï¼Œæ·»åŠ å¼‚å¸¸åˆ°æ–¹æ³•ç­¾å**

```java
package org.example;

public class Main {
    public static void main(String[] args) throws ClassNotFoundException {
        Class.forName("com.mysql.jdbc.Driver");
    }
}
```



**æˆ‘ä»¬éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œ**

```sql
select * from students;
select * from students where id < 10 and score > 80;
update students set score=88 where id = 1;
select * from students where id = 1;
```

**ä¸Šé¢çš„ä»£ç å¯ä»¥å°†`id = 1`çš„å­¦ç”Ÿåˆ†æ•°æ”¹ä¸º88ï¼Œå°†sqlå†™å…¥Javaä»£ç ä¸­ï¼š**



###  å¯¼å…¥çš„ç¬¬äºŒç§æ–¹æ³•

**é€‰æ‹©è¿™ä¸ªjar**

![image-20220921195107959](https://sm.nsddd.top//typora/image-20220921195107959.png?mail:3293172751@qq.com)

**æ·»åŠ åº“**

![image-20220921195725489](https://sm.nsddd.top//typora/image-20220921195725489.png?mail:3293172751@qq.com)





### ä¸»è¦ä»£ç 

```java
package org.example;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class Main {
    public static void main(String[] args) throws ClassNotFoundException, SQLException {
        System.out.println("Hello world!");
        //æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");

        //è·å–è¿æ¥
        String url = "jdbc:mysql://localhost:49156/learnjdbc";
        String username = "root";
        String password = "123456";
        Connection conn = DriverManager.getConnection(url,username,password);

        //å®šä¹‰sqlè¯­å¥
        String sql = "update students set score=98 where id = 1;";

        //è·å–æ‰§è¡Œsqlå¯¹è±¡statement
        Statement stem = conn.createStatement();

        //æ‰§è¡Œsql   -- è¿”å›å€¼å—å½±å“çš„è¡Œæ•° -- å¦‚æœè¿”å›ä¸º1 è¯´æ˜1è¡Œsqlæ‰§è¡ŒæˆåŠŸ
        int count = stem.executeUpdate(sql);

        //å¤„ç†ç»“æœ
        System.out.println(count);

        //é‡Šæ”¾èµ„æº -- å…ˆé‡Šæ”¾stmlå†é‡Šæ”¾conn
        stem.close();
        conn.close();
    }
}
```

**æ‰§è¡Œä»£ç ï¼š**

```
Hello world!
1
è¿›ç¨‹å·²ç»“æŸ,é€€å‡ºä»£ç 0
```

**æˆ‘ä»¬é©¬ä¸Šå»æŸ¥è¯¢æ•°æ®åº“ å¯ä»¥çœ‹å‡ºæ¥æ•°æ®ä¼šæ›´æ–°çš„**

```sq
select * from students where id = 1

id|name|gender|grade|score|
--+----+------+-----+-----+
 1|å°è´  |     0|    3|   88|
```

 ğŸ”¦ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œç®—æ˜¯é¡ºåˆ©æ‰§è¡Œäº†ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æé†’ï¼Œå°±æ˜¯éœ€è¦åœ¨



## JDBC APIè¯¦è§£

æˆ‘ä»¬éœ€è¦å…ˆå»äº†è§£ä¸€ä¸‹`jdk`å®˜æ–¹æ–‡æ¡£ï¼Œä¸Šé¢å¯¹å„ä¸ªæ¥å£æœ‰å¾ˆå¤šè§£é‡Š

### JDBCç»“æ„

+ `DriverManager`ç±»ï¼šä¾æ®æ•°æ®åº“çš„ä¸åŒï¼Œç®¡ç†JDBCé©±åŠ¨
+ `Connection`æ¥å£ï¼šè´Ÿè´£è¿æ¥æ•°æ®åº“å¹¶ä¸”æ‹…ä»»ä¼ é€æ•°æ®çš„ä»»åŠ¡
+ `Statement`æ¥å£ï¼šç”±Connectionäº§ç”Ÿã€è´Ÿè´£æ‰§è¡ŒSQLè¯­å¥
+ `ResultSet`æ¥å£ï¼šä»æ•°æ®æºè¯»å–æ•°æ®



### DriverManagerä½œç”¨

1. æ³¨å†Œé©±åŠ¨
2. è·å–æ•°æ®åº“è¿æ¥



**æ³¨å†Œé©±åŠ¨**

```
//æ³¨å†Œé©±åŠ¨
Class.forName("com.mysql.jdbc.Driver");
```

**5.0ç‰ˆæœ¬ä¹‹åå¯ä»¥çœç•¥ï¼Œå› ä¸ºè‡ªå¸¦äº†ï¼Œä¸éœ€è¦å†å†™äº†**



**è·å–æ•°æ®åº“è¿æ¥**

```java
/è·å–è¿æ¥
String url = "jdbc:mysql://localhost:49156/learnjdbc";
String username = "root";
String password = "123456";
Connection conn = DriverManager.getConnection(url,username,password);
```

+ `jdbc:mysql://localhost:49156/learnjdbc`ï¼šå¦‚æœæ˜¯æœ¬åœ°ä¸”3306ï¼Œé‚£ä¹ˆå¯ä»¥ç®€å†™`jdbc:mysql:///`ï¼ˆæˆ‘çš„æ˜¯è¿æ¥dockerï¼‰
+ é…ç½®`useSSL=false`å‚æ•°ï¼Œç¦æ­¢ç”¨å®‰å…¨è¿æ¥æ–¹å¼ï¼Œè§£å†³è­¦å‘Šæé†’



### Connectionæ•°æ®åº“è¿æ¥å¯¹è±¡

```
 //è·å–æ‰§è¡Œsqlå¯¹è±¡statement
 Statement stem = conn.createStatement();
```

+ æ‰§è¡Œ`SQL`çš„å¯¹è±¡
+ ç®¡ç†äº‹åŠ¡



**æ™®é€šæ‰§è¡ŒSQLå¯¹è±¡**

```
Statement createStatement()
```



**é¢„ç¼–è¯‘SQLçš„æ‰§è¡ŒSQLå¯¹è±¡ï¼šé˜²æ­¢SQLæ³¨å…¥**

```
PreparedStatement createStatement()
```



**æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹çš„å¯¹è±¡**

```
CallableStatement prepareCall(sql)
```



### äº‹åŠ¡ç®¡ç†

**äº‹åŠ¡æ“ä½œï¼š**

> mysqlé»˜è®¤è‡ªåŠ¨æäº¤äº‹åŠ¡

+ å¼€å¯äº‹åŠ¡ï¼š`begin;/start transaction`
+ æäº¤äº‹åŠ¡ï¼š`commit`
+ å›æ»šäº‹åŠ¡ï¼š`rollback`



**JDBCäº‹åŠ¡ç®¡ç†ï¼šConnectionæ¥å£ä¸­å®šä¹‰äº†3ä¸ªå¯¹åº”æ–¹æ³•**

+ å¼€å¯äº‹åŠ¡ï¼š`setAutoCommit(boolean autoCommit)`
  +  `ture` : è‡ªåŠ¨æäº¤
  + `false`: æ‰‹åŠ¨æäº¤
+ æäº¤äº‹åŠ¡ï¼š`commit`
+ å›æ»šäº‹åŠ¡ï¼š`rollback()`



### jdbcçš„äº‹åŠ¡æ“ä½œ

æœ‰æä¸ªé—®é¢˜ï¼šå½“ä½ å‡ºç°é”™è¯¯ï¼Œå¦‚ä½•æ£€æµ‹é”™è¯¯å¹¶ä¸”å›æ»šï¼Ÿ

æˆ‘ä»¬ä½¿ç”¨`try - catch`æ•è·

```java
 // äº‹åŠ¡  -- ä¸‹é¢ä¸¤æ¡æ•°æ®è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥

try {
     //å¼€å¯äº‹åŠ¡
     conn.setAutoCommit(false);
     //æ‰§è¡Œä»£ç 
     int count1 = stem.executeUpdate(sq2);
     System.out.println(count1);

     int count2 = stem.executeUpdate(sql2);
     System.out.println(count2);
     
     //æäº¤äº‹åŠ¡
     conn.commit();
 } catch (SQLException e) {
     //å›æ»šäº‹åŠ¡
     conn.rollback();  
     throw new RuntimeException(e);
 }
```

**å®Œæ•´ä»£ç **

```java
package org.example;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class jdbc1 {
    public static void main(String[] args) throws ClassNotFoundException, SQLException {
        System.out.println("Hello world!");
        //æ³¨å†Œé©±åŠ¨
        // Class.forName("com.mysql.jdbc.Driver");

        //è·å–è¿æ¥
        String url = "jdbc:mysql://localhost:49156/learnjdbc";
        String username = "root";
        String password = "123456";
        Connection conn = DriverManager.getConnection(url,username,password);

        //å®šä¹‰sqlè¯­å¥
        String sql1 = "update students set score=100 where id = 1;";
        String sql2 = "update students set score=100 where id = 2;";
        //è·å–æ‰§è¡Œsqlå¯¹è±¡statement
        Statement stem = conn.createStatement();

        // äº‹åŠ¡  -- ä¸‹é¢ä¸¤æ¡æ•°æ®è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥

        try {
            //å¼€å¯äº‹åŠ¡
            conn.setAutoCommit(false);
            //æ‰§è¡Œä»£ç 
            int count1 = stem.executeUpdate(sql2);
            System.out.println(count1);

            int count2 = stem.executeUpdate(sql2);
            System.out.println(count2);

            //æäº¤äº‹åŠ¡
            conn.commit();
        } catch (SQLException e) {
            //å›æ»šäº‹åŠ¡
            conn.rollback();
            throw new RuntimeException(e);
        }
        //æäº¤äº‹åŠ¡

        //é‡Šæ”¾èµ„æº -- å…ˆé‡Šæ”¾stmlå†é‡Šæ”¾conn
        stem.close();
        conn.close();
    }
}
```



**æ‰§è¡Œï¼š**

```
Hello world!
1
1

è¿›ç¨‹å·²ç»“æŸ,é€€å‡ºä»£ç 0
1	å°è´	0	3	100
2	å°å¼º	0	2	100
```



**ç”šè‡³ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹ä¸€ä¸‹ï¼š**

```java
try {
    //å¼€å¯äº‹åŠ¡
    conn.setAutoCommit(false);
    //æ‰§è¡Œä»£ç 
    int count1 = stem.executeUpdate(sql2);
    System.out.println(count1);
    int aa = 123/0;
    int count2 = stem.executeUpdate(sql2);
    System.out.println(count2);

    //æäº¤äº‹åŠ¡
    conn.commit();
} catch (SQLException e) {
    //å›æ»šäº‹åŠ¡
    conn.rollback();
    throw new RuntimeException(e);
} finally {
    System.out.println("hello word , æ‰§è¡Œå®Œæˆ ");
    //é‡Šæ”¾èµ„æº -- å…ˆé‡Šæ”¾stmlå†é‡Šæ”¾conn
    stem.close();
    conn.close();
}
```

**finallyæ˜¯åé¢å¿…é¡»è¦æ‰§è¡Œçš„ï¼Œ` int aa = 123/0;`æ˜¯ä¸€ä¸ªæº¢å‡ºé”™è¯¯ï¼Œè¿™ä¸ªæº¢å‡ºæ˜¯é™æ€è¯­è¨€æ˜¯æ²¡åŠæ³•æ£€æµ‹å‡ºæ¥çš„**



### Statementæä¾›æ–¹æ³•æ‰§è¡Œsql

```java
int count1 = stem.executeUpdate(sql1);
System.out.println(count1);
int count2 = stem.executeUpdate(sql2);
System.out.println(count2);
```



#### æ‰§è¡Œsqlè¯­å¥

```java
int executeUpdate(sql):æ‰§è¡ŒDMLã€DDLè¯­å¥;
```

**è¿”å›å€¼ï¼š**

+ DMLè¯­å¥å½±å“çš„è¡Œæ•°
+ DDLè¯­å¥æ‰§è¡Œåï¼Œ æ‰§è¡ŒæˆåŠŸä¹Ÿå¯èƒ½è¿”å›0



#### DML è¯­å¥

**æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªæµ‹è¯•ç±»**

```java
package org.example;
import org.junit.Test;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class Jdbc2 {
    @Test
    public void testDML() throws SQLException {
        System.out.println("Hello world!");
        //æ³¨å†Œé©±åŠ¨
        // Class.forName("com.mysql.jdbc.Driver");

        //è·å–è¿æ¥
        String url = "jdbc:mysql://localhost:49156/learnjdbc";
        String username = "root";
        String password = "123456";
        Connection conn = DriverManager.getConnection(url,username,password);

        //å®šä¹‰sqlè¯­å¥
        String sql = "update students set score=10000 where id = 1;";
        //è·å–æ‰§è¡Œsqlå¯¹è±¡statement
        Statement stem = conn.createStatement();

        //æ‰§è¡Œsql   -- è¿”å›å€¼å—å½±å“çš„è¡Œæ•° -- å¦‚æœè¿”å›ä¸º1 è¯´æ˜1è¡Œsqlæ‰§è¡ŒæˆåŠŸ
        int count = stem.executeUpdate(sql);
        //å¤„ç†ç»“æœ
        System.out.println(count);

        //é‡Šæ”¾èµ„æº -- å…ˆé‡Šæ”¾stmlå†é‡Šæ”¾conn
        stem.close();
        conn.close();
    }
}
```



**æˆ‘ä»¬å¯ä»¥æŠŠå¤„ç†ç»“æœä¿®æ”¹ä¸€ä¸‹**

```java
if (count > 0) {
    System.out.Println("ä¿®æ”¹æˆåŠŸ");
}else {
    System.out.Println("ä¿®æ”¹å¤±è´¥");  
}
```



#### æ·»åŠ åˆ é™¤è¯­å¥

> æ›´æ–°è®°å½•æ—¶è¦å°å¿ƒã€‚å¦‚æœçœç•¥è¯¥` WHERE`å­å¥ï¼Œæ‰€æœ‰è®°å½•éƒ½å°†è¢«æ›´æ–°ï¼

**åˆ é™¤è®°å½•**

```
 String sql = "delete  from students  where id = 2";
```



**æ·»åŠ è®°å½•**

```sql
#1.æŒ‡å®šåˆ—åå’Œè¦æ’å…¥çš„å€¼ï¼š
INSERT INTO table_name (column1, column2, column3, ...)
VALUES (value1, value2, value3, ...);

#2. å¦‚æœè¦ä¸ºè¡¨çš„æ‰€æœ‰åˆ—æ·»åŠ å€¼ï¼Œåˆ™ä¸éœ€è¦åœ¨ SQL æŸ¥è¯¢ä¸­æŒ‡å®šåˆ—åã€‚ä½†æ˜¯ï¼Œè¯·ç¡®ä¿å€¼çš„é¡ºåºä¸è¡¨ä¸­åˆ—çš„é¡ºåºç›¸åŒã€‚åœ¨è¿™é‡Œï¼Œ INSERT INTOè¯­æ³•å¦‚ä¸‹ï¼š
INSERT INTO table_name
VALUES (value1, value2, value3, ...);
```



#### DDL è¯­å¥

**åˆ›å»ºæ•°æ®åº“æ“ä½œ**

```java
package org.example;
import org.junit.Test;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class Jdbc2 {
    @Test
    public void testDML() throws SQLException {
        System.out.println("Hello world!");
        //æ³¨å†Œé©±åŠ¨
        // Class.forName("com.mysql.jdbc.Driver");

        //è·å–è¿æ¥
        String url = "jdbc:mysql://localhost:49156/learnjdbc";
        String username = "root";
        String password = "123456";
        Connection conn = DriverManager.getConnection(url,username,password);

        //å®šä¹‰sqlè¯­å¥
        String sql = "create database db2";
        //è·å–æ‰§è¡Œsqlå¯¹è±¡statement
        Statement stem = conn.createStatement();

        //æ‰§è¡Œsql   -- è¿”å›å€¼å—å½±å“çš„è¡Œæ•° -- å¦‚æœè¿”å›ä¸º1 è¯´æ˜1è¡Œsqlæ‰§è¡ŒæˆåŠŸ
        int count = stem.executeUpdate(sql);
        //å¤„ç†ç»“æœ
        if (count > 0) {
            System.out.println("åˆ›å»ºæ•°æ®åº“æˆåŠŸ");
        }else {
            System.out.println("åˆ›å»ºæ•°æ®åº“å¤±è´¥");
        }

        //é‡Šæ”¾èµ„æº -- å…ˆé‡Šæ”¾stmlå†é‡Šæ”¾conn
        stem.close();
        conn.close();
    }
}
```

**ä½†æ˜¯åˆ é™¤æ•°æ®åº“çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¸º0**

> ä»”ç»†æƒ³æƒ³ï¼ŒDDLæ‰§è¡Œååˆ é™¤äº†ä¸å°±æ˜¯0 å˜›

![image-20220921221911040](https://sm.nsddd.top//typora/image-20220921221911040.png?mail:3293172751@qq.com)

## END é“¾æ¥

+ [å›åˆ°ç›®å½•](../README.md)
+ [ä¸Šä¸€èŠ‚](25.md)
+ [ä¸‹ä¸€èŠ‚](27.md)
---
+ [å‚ä¸è´¡çŒ®â¤ï¸ğŸ’•ğŸ’•](https://github.com/3293172751/Block_Chain/blob/master/Git/git-contributor.md)